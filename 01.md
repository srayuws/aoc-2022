# Day-01

## 上半截

题目比较简单，输入是若干组数，组与组之间靠空行分隔。问题是对每组数进行求和，找总和（sum）最大的一组，问这个总和是多少。

样例数据：

| A      | 
|  ---   | 
| 1000   |
| 2000   |
| 3000   |
| _      |
| 4000   |
| _      |
| 5000   |
| 6000   |
| _      |
| 7000   |
| 8000   |
| 9000   |
| _      |
| 10000  |

思路非常直白，在 B 列里放当前组的累积和，如下：

| A      |  B     |
|  ---   | ---    | 
| 1000   | 1000   |
| 2000   | 3000   |
| 3000   | 6000   |
| _      | _      |
| 4000   | 4000   |
| _      | _      |
| 5000   | 5000   |
| 6000   | 11000  |
| _      | _      |
| 7000   | 7000   |
| 8000   | 15000  |
| 9000   | 24000  |
| _      | _      |
| 10000  | 10000  |

接下来的问题就是怎么写公式，累积和很简单： $B_n = B_{n-1} + A_n$ 。
唯一需要注意的就是每组开头的那个累积和要设为0。 正好输入数据里有一个空行可以利用，所以我在最开始加了一个空行，然后公式如下：

| A      |  B                    |
|  ---   | ---                   | 
| _      | 0                     |
| 1000   | =IF($A2>0,$A2+$B1,0)  |

IF 的false分支就是重置累积和为0的地方。

公式一路拖到最下面，然后随便找个地方写个 `=MAX(B:B)` 完事。

## 下半截

后半段的题目变成了找前3大的累积和，然后求他们的和。

开始的想法是，是不是可以把所有数排个序，找到最大的三个就行了。但是一琢磨发现很明显有问题，譬如上面的样例数据，第二大的累积和，其实就是最大的那一组里面的中间值（15000）。
解决方法也很简单，还是在之前用来重置累积和的地方做文章，把公式改成 ` =IF($A2>0,$A2+$B1, -1*$B1) `， false分支变成了前一组数的累积和的负数形式。
样例数据也变成了


| A      |  B     |
|  ---   | ---    | 
| 1000   | 1000   |
| 2000   | 3000   |
| 3000   | 6000   |
| _      | -6000  |
| 4000   | 4000   |
| _      | -4000  |
| 5000   | 5000   |
| 6000   | 11000  |
| _      | -11000 |
| 7000   | 7000   |
| 8000   | 15000  |
| 9000   | 24000  |
| _      | -24000 |
| 10000  | 10000  |
| _      | -10000 |

还是抄出来，排序，这次找最小的三个数，手动拖一下抄答案。

其实后来还搜了一下，又学会两个新函数 [LARGE(array, k)](https://support.microsoft.com/en-us/office/large-function-3af0af19-1190-42bb-bb8b-01672ec00a64) 和 [SMALL(array, k)](https://support.microsoft.com/en-us/office/small-function-17da8222-7c82-42b2-961b-14c45384df07)
其实就是常说的 TopK。

